# 星空会员管理系统开发文档

## 一、使用vue-cli创建项目

### 1.1 创建项目

```
vue create admin-system
```

### 1.2 进入项目目录

```
cd admin-system
```

### 1.3 启动项目

```
npm run serve
```

## 二、对项目进行基础配置

> 这块的配置方式有两种: 
>
> 1. 第一种是在index.html中进行配置
> 2. 第二种是通过vue.config.js里面来进行设定

### 2.1 配置网页的标题

`public/index.html`

```html
<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" href="<%= BASE_URL %>favicon.ico">
<!--    <title><%= htmlWebpackPlugin.options.title %></title>-->
    <title>星空会员管理系统</title>
  </head>
  <body>
    <noscript>
      <strong>We're sorry but <%= htmlWebpackPlugin.options.title %> doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
    </noscript>
    <div id="app"></div>
    <!-- built files will be auto injected -->
  </body>
</html>

```

效果截图:

![image-20220519141420492](星空会员管理系统开发文档.assets/image-20220519141420492.png)

### 2.2 配置网页的icon图标

1. 需要有一张jpg、png格式的图片

2. 使用在线图标生成器转化图标

   http://www.51tool.com/

3. 将转化之后的图标放到`public`文件夹当中

```html
<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" href="<%= BASE_URL %>favicon.ico">
<!--    <title><%= htmlWebpackPlugin.options.title %></title>-->
    <title>星空会员管理系统</title>
  </head>
  <body>
    <noscript>
      <strong>We're sorry but <%= htmlWebpackPlugin.options.title %> doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
    </noscript>
    <div id="app"></div>
    <!-- built files will be auto injected -->
  </body>
</html>

```

最终效果:

![image-20220519142131991](星空会员管理系统开发文档.assets/image-20220519142131991.png)

### 2.3 在vue.config.js对项目进行配置

1. 关闭eslint代码检测
2. 启动的端口号
3. 配置主机名
4. 配置浏览器自动打开
5. 配置https协议默认不开启

```javascript
module.exports = {
  // 配置服务器
  devServer : {
    // 启动的端口号
    port : 9999,
    // 主机名
    host : "localhost",
    // 是否开启https
    https : false,
    // 浏览器自动打开
    open : true
  },
  // 关闭eslint代码质量检测
  lintOnSave : false
}

```



### 2.4 安装axios

```
npm i axios --save
```



### 2.5 配置跨域

1. ###### 什么是同源?

   如果两个页面（接口）的协议、域名、端口号都相同，我们认为他们具有相同的源

2. ###### 什么是同源策略?

   同源策略就是浏览器的一个安全限制，它阻止了不同【域】之间进行的数据交互

3. ###### 安全限制具体都组织了那些东西不可以被访问?

   1.无法读取非同源策略下的cookie、localstorage

   2.无法解除非同源的dom 

   3.无法向非同源的地址发送ajax请求

4. ###### 想要进行数据交互怎么办？

   跨域: 

   	1. jsonp 
    	2. cors 后端允许跨域
    	3. iframe
    	4. 代理 (vue采用的就是这种方式)

#### 2.5.1 演示跨域

![image-20220519144933059](星空会员管理系统开发文档.assets/image-20220519144933059.png)

![image-20220519145948583](星空会员管理系统开发文档.assets/image-20220519145948583.png)

#### 2.5.2 配置跨域

`vue.config.js`

```javascript
/**
 * @author YangLing
 * @date 2022/5/19 2:23 PM
 */
module.exports = {
  // 配置服务器
  devServer : {
    // 启动的端口号
    port : 9999,
    // 主机名
    host : "localhost",
    // 是否开启https
    https : false,
    // 浏览器自动打开
    open : true,
    // 配置跨域
    proxy : {
      //  "/dev-api" 代理名称， 当我们请求"/dev-api"的时候就相当于请求http://localhost:8888
      "/dev-api" : {
        // target 后面写的是要跨域的地址
        target : "http://localhost:8888",
        // 开启跨域
        changeOrigin : true,
        // 代理路径重写
        pathRewrite : {
          "^/dev-api" : ""
        }
      }
    }
  },
  // 关闭eslint代码质量检测
  lintOnSave : false
}


```

效果演示: 

![image-20220519150734330](星空会员管理系统开发文档.assets/image-20220519150734330.png)

#### 2.5.3 结合环境变量文件去配置跨域

1. 创建`.env.development`

   ```
   # 代理名称
   VUE_APP_BASE_API = "/dev-api"
   
   # 代理地址
   VUE_APP_SERVICE_URL = "http://member.9yuecloud.com:8889"
   
   ```

   

2. 创建`.env.production`

   ```
   # 代理名称
   VUE_APP_BASE_API = "/pro-api"
   ```

   

![image-20220519154842229](星空会员管理系统开发文档.assets/image-20220519154842229.png)

3. `vue.config.js`

   ```javascript
   /**
    * @author YangLing
    * @date 2022/5/19 2:23 PM
    */
   module.exports = {
     // 解决打包之后白屏的问题
     publicPath : "./",
     // 配置服务器
     devServer : {
       // 启动的端口号
       port : 9999,
       // 主机名
       host : "localhost",
       // 是否开启https
       https : false,
       // 浏览器自动打开
       open : true,
       // 配置跨域
       proxy : {
         //  "/dev-api" 代理名称， 当我们请求"/dev-api"的时候就相当于请求http://localhost:8888
         // "/pro-api" : {
         [process.env.VUE_APP_BASE_API] : {
           // target 后面写的是要跨域的地址
           target : process.env.VUE_APP_SERVICE_URL,
           // 开启跨域
           changeOrigin : true,
           // 代理路径重写
           pathRewrite : {
             ["^" + process.env.VUE_APP_BASE_API] : ""
           }
         }
       }
     },
     // 关闭eslint代码质量检测
     lintOnSave : false
   }
   ```

   

### 2.6 配置线上跨域

 1. 打包项目

    ```
    npm run build
    ```

	2. 把打包之后的dist文件的内容扔到服务器上面

	3. 配置线上跨域

    ![image-20220519155729798](星空会员管理系统开发文档.assets/image-20220519155729798.png)



## 三、axios二次封装

1. 引入axios
2. 创建axios实例对象
3. 创建请求拦截器
4. 创建响应拦截器
5. 导出axios实例对象

`utils/request.js`

```javascript
/**
 * @author YangLing
 * @date 2022/5/19 4:00 PM
 */
// 引入axios
import axios from "axios"

// 创建axios实例对象
const service = axios.create({
  // 请求的公共接口地址， 如果配置了跨域，我们baseURL一般写的是跨域的代理名称
  baseURL : process.env.VUE_APP_BASE_API,
  timeout : 10000
});

// 添加请求拦截器
service.interceptors.request.use(function (config) {

  return config;
}, function (error) {

  return Promise.reject(error);
});

// 添加响应拦截器
service.interceptors.response.use(function (response) {

  return response;
}, function (error) {

  return Promise.reject(error);
});

// 导出axios实例对象
export default service



```



## 四、API接口封装

1. api封装

   ```javascript
   /**
    * @author YangLing
    * @date 2022/5/19 4:08 PM
    */
   
   import service from "../utils/request"
   
   const login = (data)=>{
       return service({url : "/v2/admin/login", method : "POST", data})
   }
   
   export default {
     login
   }
   
   ```

   

2. api调用

   ```javascript
   methods : {
      async handleSend(){
         // .then .catch .all .race promise独有的方法
        const res = await User.login({username:"admin", password : "admin"})
        console.log(res)
       }
     }
   ```

